---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "doublecloud_clickhouse_cluster Resource - terraform-provider-doublecloud"
subcategory: ""
description: |-
  ClickHouse Cluster resource
---

# doublecloud_clickhouse_cluster (Resource)

ClickHouse Cluster resource

## Example Usage

```terraform
resource "doublecloud_clickhouse_cluster" "example-clickhouse" {
  project_id = var.project_id
  name       = "example-clickhouse"
  region_id  = "eu-central-1"
  cloud_type = "aws"
  network_id = data.doublecloud_network.default.id

  resources {
    clickhouse {
      resource_preset_id = "s1-c2-m4"
      disk_size          = 34359738368
      replica_count      = 1
    }
  }

  config {
    log_level       = "LOG_LEVEL_TRACE"
    max_connections = 120
  }

  access {
    data_services = ["transfer"]
    ipv4_cidr_blocks = [
      {
        value       = "10.0.0.0/8"
        description = "Office in Berlin"
      }
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud_type` (String) Cloud provider where the cluster is created. Possible values: `aws` and `gcp`
- `name` (String) Cluster name
- `network_id` (String) ID of the network where the cluster is created
- `project_id` (String) ID of the project where the ClickHouse cluster is created
- `region_id` (String) ID of the region where resources are created

### Optional

- `access` (Block, Optional) Access control configuration (see [below for nested schema](#nestedblock--access))
- `config` (Block, Optional) (see [below for nested schema](#nestedblock--config))
- `description` (String) Cluster description
- `id` (String) Cluster ID
- `resources` (Block, Optional) Cluster resources (see [below for nested schema](#nestedblock--resources))
- `version` (String) Version of the ClickHouse DBMS

### Read-Only

- `connection_info` (Attributes) Public connection info (see [below for nested schema](#nestedatt--connection_info))
- `private_connection_info` (Attributes) Private connection info (see [below for nested schema](#nestedatt--private_connection_info))

<a id="nestedblock--access"></a>
### Nested Schema for `access`

Optional:

- `data_services` (List of String) List of allowed services
- `ipv4_cidr_blocks` (Attributes List) IPv4 CIDR blocks (see [below for nested schema](#nestedatt--access--ipv4_cidr_blocks))
- `ipv6_cidr_blocks` (Attributes List) IPv6 CIDR blocks (see [below for nested schema](#nestedatt--access--ipv6_cidr_blocks))

<a id="nestedatt--access--ipv4_cidr_blocks"></a>
### Nested Schema for `access.ipv4_cidr_blocks`

Required:

- `value` (String) CIDR block

Optional:

- `description` (String) CIDR block description


<a id="nestedatt--access--ipv6_cidr_blocks"></a>
### Nested Schema for `access.ipv6_cidr_blocks`

Required:

- `value` (String) CIDR block

Optional:

- `description` (String) CIDR block description



<a id="nestedblock--config"></a>
### Nested Schema for `config`

Optional:

- `asynchronous_insert_log_enabled` (Boolean) Enable logging asynchronous inserts
- `asynchronous_insert_log_retention_size` (Number) Maximum size of the asynchronous insert log table in bytes
- `asynchronous_insert_log_retention_time` (String) Retention time of the asynchronous insert log table in the duration string format, such as `2h45m`
- `asynchronous_metric_log_enabled` (Boolean) Enable logging asynchronous metrics
- `asynchronous_metric_log_retention_size` (Number) Maximum size of the asynchronous insert log table in bytes
- `asynchronous_metric_log_retention_time` (String) Retention time of the asynchronous insert log table in the duration string format, such as `2h45m`
- `background_common_pool_size` (Number) Number of threads performing various operations (mostly garbage collection) for tables with MergeTree engines
- `background_fetches_pool_size` (Number) Number of threads performing background fetches for replicated tables
- `background_merges_mutations_concurrency_ratio` (Number) Ratio of the number of threads to the number of background merges and mutations that can be executed concurrently
- `background_message_broker_schedule_pool_size` (Number) Number of threads for executing background message translation operations
- `background_move_pool_size` (Number) Number of threads performing background moves of data parts for tables with MergeTree engines
- `background_pool_size` (Number) Number of threads performing background merges and mutations for tables with MergeTree engines
- `background_schedule_pool_size` (Number) Number of threads for background jobs for replicated tables, streams in Apache Kafka, and DNS cache updates
- `kafka` (Block, Optional) (see [below for nested schema](#nestedblock--config--kafka))
- `keep_alive_timeout` (String) Time in seconds for which ClickHouse waits for incoming requests before closing the connection
- `log_level` (String) Level of logged events, such as `ERROR` or `TRACE`
- `mark_cache_size` (Number) Approximate size in bytes of the mark cache used by table engines in the MergeTree family
- `max_concurrent_queries` (Number) Maximum number of requests processed simultaneously
- `max_connections` (Number) Maximum number of inbound client connections
- `max_partition_size_to_drop` (Number) Maximum partition size in bytes for the MergeTree family at which a table can be deleted using the `DROP TABLE` query
- `max_table_size_to_drop` (Number) Maximum size in bytes of a table in the MergeTree family that can be deleted using the `DROP TABLE` query
- `metric_log_enabled` (Boolean) Enable logging metric values from the `system.metrics` and the `system.events` tables to `system.metric_log`
- `metric_log_retention_size` (Number) Maximum size of the metric log table in bytes
- `metric_log_retention_time` (String) Retention time of the metric log table in the duration string format, such as `2h45m`
- `opentelemetry_span_log_enabled` (Boolean) Enable log trace and metric values from a distributed application
- `opentelemetry_span_log_retention_size` (Number) Maximum size of the opentelemetry span log table in bytes
- `opentelemetry_span_log_retention_time` (String) Retention time of the opentelemetry span log table in the duration string format, such as `2h45m`
- `part_log_retention_size` (Number) Maximum size of the part log table in bytes
- `part_log_retention_time` (String) Retention time of the part log table in the duration string format, such as `2h45m`
- `query_log_retention_size` (Number) Maximum size of the query log table in bytes
- `query_log_retention_time` (String) Retention time of the query log table in the duration string format, such as `2h45m`
- `query_thread_log_enabled` (Boolean) Enable logging query threads
- `query_thread_log_retention_size` (Number) Maximum size of the query thread log table in bytes
- `query_thread_log_retention_time` (String) Retention time of the query thread log table in the duration string format, such as `2h45m`
- `query_views_log_enabled` (Boolean) Enable logging query views
- `query_views_log_retention_size` (Number) Maximum size of the query views log table in bytes
- `query_views_log_retention_time` (String) Retention time of the query views log table in the duration string format, such as `2h45m`
- `session_log_enabled` (Boolean) Enable logging successful and failed login/logout events
- `session_log_retention_size` (Number) Maximum size of the session log table in bytes
- `session_log_retention_time` (String) Retention time of the session log in the duration string format, such as `2h45m`
- `text_log_enabled` (Boolean) Enable system logs
- `text_log_level` (String) Level of logging, such as `ERROR` or `TRACE`
- `text_log_retention_size` (Number) Maximum size of the text log table in bytes
- `text_log_retention_time` (String) Retention time of the text log table in the duration string format, such as `2h45m`
- `timezone` (String) Cluster time zone from the IANA Time Zone Database, such as `Africa/Abidjan`
- `total_memory_profiler_step` (Number) RAM in bytes for a stack trace at each memory allocation step
- `total_memory_tracker_sample_probability` (Number) Allows collecting and logging informaiton about random memory allocation and release with the specified probability
- `trace_log_enabled` (Boolean) Enable logging stack traces collected by the query profiler
- `trace_log_retention_size` (Number) Maximum size of the trace log table in bytes
- `trace_log_retention_time` (String) Retention time of the trace log table in the duration string format, such as `2h45m`
- `uncompressed_cache_size` (Number) Cache size in bytes for uncompressed data used by table engines in the MergeTree family
- `zookeeper_log_enabled` (Boolean) Enable logging parameters of requests to the ZooKeeper server and responses from it
- `zookeeper_log_retention_size` (Number) Maximum size of the ZooKeeper log table in bytes
- `zookeeper_log_retention_time` (String) Retention time of the ZooKeeper log table in the duration string format, such as `2h45m`

<a id="nestedblock--config--kafka"></a>
### Nested Schema for `config.kafka`

Optional:

- `enable_ssl_certificate_verification` (Boolean) Enable SSL certificate verification
- `max_poll_interval_ms` (String) Maximum interval in milliseconds between making poll calls to get messages for high-level consumers
- `sasl_mechanism` (String) SASL authentication mechanism
- `sasl_password` (String, Sensitive) Apache Kafka® account password
- `sasl_username` (String) Apache Kafka® account username
- `security_protocol` (String) Security protocol used for authentication
- `session_timeout_ms` (String) Timeout to maintain a client group session



<a id="nestedblock--resources"></a>
### Nested Schema for `resources`

Optional:

- `clickhouse` (Block, Optional) Resources available to ClickHouse hosts (see [below for nested schema](#nestedblock--resources--clickhouse))
- `dedicated_keeper` (Block, Optional) Resources available to dedicated ClickHouse Keeper hosts (see [below for nested schema](#nestedblock--resources--dedicated_keeper))

<a id="nestedblock--resources--clickhouse"></a>
### Nested Schema for `resources.clickhouse`

Optional:

- `disk_size` (Number) Storage volume available to a host in bytes
- `max_disk_size` (Number) Maximum storage volume the cluster can automatically scale up to in bytes. If not set, autoscaling is disabled
- `max_resource_preset_id` (String) ID of the maximal computational resources preset available to a host (CPU, memory, etc.)
- `min_resource_preset_id` (String) ID of the minimal computational resources preset available to a host (CPU, memory, etc.)
- `replica_count` (Number) Number of hosts per shard
- `resource_preset_id` (String) ID of the computational resources preset available to a host (CPU, memory, etc.)
- `shard_count` (Number) Number of shards in the cluster


<a id="nestedblock--resources--dedicated_keeper"></a>
### Nested Schema for `resources.dedicated_keeper`

Optional:

- `disk_size` (Number) Volume of the storage available to a host in bytes
- `max_disk_size` (Number) Maximum storage volume the cluster can automatically scale up to in bytes. If not set, autoscaling is disabled
- `max_resource_preset_id` (String) ID of the maximal computational resources preset available to a host (CPU, memory, etc.)
- `min_resource_preset_id` (String) ID of the minimal computational resources preset available to a host (CPU, memory, etc.)
- `replica_count` (Number) Number of keeper hosts
- `resource_preset_id` (String) ID of the computational resources preset available to a host (CPU, memory, etc.)



<a id="nestedatt--connection_info"></a>
### Nested Schema for `connection_info`

Read-Only:

- `host` (String) Host to connect to
- `https_port` (Number) Port to connect to using the HTTPS protocol
- `https_uri` (String) URI to connect to using the HTTPS protocol
- `jdbc_uri` (String) URI to connect to using the JDBC protocol
- `native_protocol` (String) Connection string for the ClickHouse native protocol
- `odbc_uri` (String) URI to connect to using the ODBC protocol
- `password` (String, Sensitive) Password for the ClickHouse user
- `tcp_port_secure` (Number) Port to connect to using the TCP/native protocol
- `user` (String) ClickHouse user


<a id="nestedatt--private_connection_info"></a>
### Nested Schema for `private_connection_info`

Read-Only:

- `host` (String) Host to connect to
- `https_port` (Number) Port to connect to using the HTTPS protocol
- `https_uri` (String) URI to connect to using the HTTPS protocol
- `jdbc_uri` (String) URI to connect to using the JDBC protocol
- `native_protocol` (String) Connection string for the ClickHouse native protocol
- `odbc_uri` (String) URI to connect to using the ODBC protocol
- `password` (String, Sensitive) Password for the ClickHouse user
- `tcp_port_secure` (Number) Port to connect to using the TCP/native protocol
- `user` (String) ClickHouse user
